---
title: "Parcial I"

lang: es

format: 
  closeread-html:
   css: msaz.css
   code-tools: false
   fig-format: svg
   toc: true
   linkcolor: tomato
---

üìÖ **Fecha L√≠mite:** Martes 18 de febrero, 6:00 p.m.

**Formato de Entrega:** Me env√≠an el R Script al correo con el formato usual `nombre_apellido.R`. Si realizan el trabajo en parejas, nombren el archivo `nombre1_apellido1_nombre2_apellido2.R`. *Antes de enviar el archivo, aseg√∫rense de que su c√≥digo se ejecuta correctamente en un nuevo R Script limpio*.


**Criterios de evaluaci√≥n:**

‚úî C√≥digo correcto y bien estructurado: si el c√≥digo no ejecuta, descuento la mitad del punto.

‚úî Gr√°ficos generados correctamente: Uso de `ggplot2` con etiquetas claras y colores adecuados.

‚úî Interpretaci√≥n y an√°lisis: Respuesta clara a las preguntas en comentarios y que sea concisa. Si su respuesta tiene m√°s de 3 l√≠neas es **muy** larga.

‚úî Formato y organizaci√≥n: C√≥digo limpio, comentado y con t√≠tulos adecuados en el documento.


## Descripci√≥n del Dataset de Spotify

     
## Ejercicio 0

Abran un R Script, y utilizando la siguiente plantilla, carguen el paquete `tidyverse`. Inst√°lenlos desde la consola si es la primera vez que usan su PC actual.



```{r}
#| eval: true
#| echo: true
#| warning: false

## ------------------------------
## An√°lisis de Spotify
##
## Autor(es): 
##
## Fecha: 
## ------------------------------


## cargamos todos los paquetes que usaremos en la sesi√≥n:

library(tidyverse)
library(fivethirtyeight)

## ---------------------------

### Ejercicio 1

bechdel_data <- bechdel


bechdel_data <- bechdel_data |>
  mutate(
    bechdel_test = case_when(
      clean_test == "ok" ~ "passes test",
      clean_test == "dubious" ~ "dubious",
      clean_test == "men" ~ "women only talk about men",
      clean_test == "notalk" ~ "women don‚Äôt talk to each other",
      clean_test == "nowomen" ~ "fewer than two women",
      TRUE ~ NA_character_  # Default case (if needed)
    )
  ) |>
  mutate(bechdel_test = factor(bechdel_test, levels = c("passes test", "dubious", "women only talk about men", "women don‚Äôt talk to each other", "fewer than two women")))


bechdel_data <- bechdel_data |> 
  mutate(decade = case_when(
    year >= 1970 & year < 1980 ~ "1970-1980",
    year >= 1980 & year < 1990 ~ "1980-1990",
    year >= 1990 & year < 2000 ~ "1990-2000",
    year >= 2000 & year <= 2013 ~ "2000-2013",
    TRUE ~ "Other" # Optional for handling unexpected years
  ))

bechdel_data <- bechdel_data |>
  select(year, decade, title, binary, bechdel_test,budget_2013, domgross_2013, intgross_2013)

```


## Ejercicio 1

a) Su colega cre√≥ la siguiente gr√°fica. Con base en este c√≥digo, genere una versi√≥n estandarizada del gr√°fico de barras, reemplazando `position = "dodge"` por la opci√≥n correspondiente.


::: {.columns}
::: {.column width=50%}

```{r}
#| eval: false
#| echo: true


ggplot(bechdel_data, aes(x=decade, fill=bechdel_test)) +
  geom_bar(position = "dodge") +
  labs(x="Decade",
       y="Frequency",
       fill="Bechdel Test")+
  theme_minimal()

```
:::

::: {.column width=50%}


```{r}
#| eval: true
#| echo: false
#| warning: false
#| fig-align: center

ggplot(bechdel_data, aes(x=decade, fill=bechdel_test)) +
  geom_bar(position = "dodge") +
  labs(x="Decade",
       y="Frequency",
       fill="Bechdel Test")+
  theme_minimal()

```

:::
:::


b) Identifique tres observaciones relevantes sobre los datos bas√°ndose en ambas visualizaciones. Justifique cada observaci√≥n con informaci√≥n extra√≠da de los gr√°ficos.

## Ejercicio 2


```{r}
#| eval: true
#| echo: false
#| warning: false
#| fig-align: center
#| fig-width: 10

ggplot(bechdel_data, aes(x=(budget_2013/1000000), y=bechdel_test)) +
  geom_boxplot() +
  labs(x="Budget in 2013 dollars (millions)",
       y="Bechdel Test") +
  theme_minimal()

```


a) Formulen una conclusi√≥n basada en el gr√°fico utilizando una medida de tendencia central.

b) Si una productora quiere invertir en pel√≠culas con presupuestos m√°s predecibles (menos variabilidad), ¬øqu√© categor√≠a deber√≠a evitar y por qu√©?

c) Formulen una conclusi√≥n basada en los valores at√≠picos observados en el gr√°fico.

d) ¬øExiste alguna categor√≠a cuyo presupuesto tenga una distribuci√≥n m√°s sim√©trica en comparaci√≥n con las dem√°s? Justifiquen su respuesta con base en la forma de los diagramas de caja.

## Ejercicio 3

Al analizar el impacto del presupuesto en los ingresos de una pel√≠cula, es importante considerar si la relaci√≥n entre ambas variables var√≠a en el mercado dom√©stico y el internacional. En el contexto del Bechdel test, esto puede revelar si las pel√≠culas con mayor representaci√≥n femenina enfrentan diferencias en su desempe√±o financiero seg√∫n el mercado en el que se estrenan. 

El primer paso para esto es responder: **¬øla relaci√≥n entre presupuesto e ingresos es m√°s fuerte en el mercado dom√©stico o en el internacional?** Para esto, su colega construy√≥ los siguientes gr√°ficos de dispersi√≥n:

```{r}
#| eval: true
#| echo: false
#| warning: false
#| fig-align: center
#| fig-width: 10

library(patchwork)
p1 <- ggplot(bechdel_data, aes(x=budget_2013/1000000, y=domgross_2013/1000000)) +
  geom_point() + geom_smooth()+
  labs(x="Budget in 2013 dollars (millions)",
       y="Domestic Gross in 2013 dollars (millions)")+
  theme_minimal()

p2  <- ggplot(bechdel_data, aes(x=budget_2013/1000000, y=intgross_2013/1000000)) +
  geom_point() + geom_smooth()+
  labs(x="Budget in 2013 dollars (millions)",
       y="International Gross in 2013 dollars (millions)")+
  theme_minimal()

p1+p2

```

Adem√°s, las correlaciones entre los recaudos y el presupuesto son:

```{r}
#| eval: true
#| echo: true
#| warning: false


cor(bechdel_data$budget_2013, bechdel_data$domgross_2013,  use="complete.obs")
cor(bechdel_data$budget_2013, bechdel_data$intgross_2013,  use="complete.obs")

```

a) ¬øLa relaci√≥n entre las variables en los gr√°ficos de dispersi√≥n es consistente con los valores de correlaci√≥n obtenidos? Justifica tu respuesta.

b) ¬øPor qu√© podr√≠a haber una diferencia en la correlaci√≥n entre el presupuesto y los ingresos dom√©sticos vs. internacionales?

## Ejercicio 4

Una empresa de cine quiere invertir en pel√≠culas con presupuestos superiores a $50 millones. Un colega tuyo estaba analizando si las pel√≠culas que pasan el test de Bechdel ser√≠an una buena opci√≥n para esta empresa. Sin embargo, dej√≥ el c√≥digo incompleto.

a) Completa el c√≥digo para estimar un intervalo de confianza del 95% para el presupuesto promedio de las pel√≠culas que pasan el test de Bechdel.

```{r}
#| eval: false
#| echo: true
#| warning: false

_________ <- bechdel_data|>
  filter(binary == "PASS")

t.test(pass_data$___________, conf.level = 0.95)
```

b) Interpreta el intervalo de confianza obtenido y responde: ¬øQu√© recomendaci√≥n le dar√≠as a la empresa sobre invertir en estas pel√≠culas?

c) Estima el intervalo de confianza con un nivel del 99%. ¬øC√≥mo cambia tu recomendaci√≥n a la empresa en este caso?

d) Explica la implicaci√≥n de utilizar un nivel de confianza del 99% en lugar del 95% en la toma de decisiones de la empresa. ¬øC√≥mo afecta esto la precisi√≥n?

## Ejercicio 5

Un grupo de investigadores est√° analizando la evoluci√≥n de la representaci√≥n femenina en el cine utilizando la prueba de Bechdel. Han recibido informes de que, en d√©cadas recientes, la proporci√≥n de pel√≠culas que pasan la prueba ha aumentado significativamente en comparaci√≥n con d√©cadas anteriores. Para verificar esto, deciden realizar un an√°lisis estad√≠stico.

Preguntas:

a) ¬øCu√°l deber√≠a ser la hip√≥tesis nula en este an√°lisis? Explique brevemente.

b) Si eres un analista de cine y trabajas para una organizaci√≥n que busca mejorar la representaci√≥n femenina en la industria, ¬øcu√°l de los dos errores te preocupar√≠a m√°s? Explica tu razonamiento.

c) ¬øTu respuesta cambiar√≠a si estuvieras en una empresa productora que decide invertir en pel√≠culas bas√°ndose en estos datos? ¬øPor qu√©?

d) Explique en palabras la prueba de hip√≥tesis que su colega estaba tratando de evaluar con el siguiente c√≥digo. 

```{r}
#| eval: true
#| echo: true
#| warning: false


test_budget <- t.test(budget_2013 ~ binary,data = bechdel_data, conf.level = 0.95)

test_budget

```


e) El p-value de la prueba es `r format(test_budget$p.value, scientific = FALSE)`. ¬øCu√°l es el resultado de la prueba?¬øPor qu√©?
