<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.290">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Analítica de los Negocios</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="index_files/libs/quarto-contrib/intersection-observer-polyfill-1.0.0/intersection-observer.js"></script>
<script src="index_files/libs/quarto-contrib/scrollama-3.2.0/scrollama.min.js"></script>
<script src="index_files/libs/quarto-contrib/closeread-0.1.0/closeread.js"></script>
<meta cr-debug-mode="false">
<meta cr-remove-header-space="false">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="_extensions/qmd-lab/closeread/closeread.css">
<link rel="stylesheet" href="msaz.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Explora el contenido</h2>
   
  <ul>
  <li><a href="#contexto" id="toc-contexto" class="nav-link active" data-scroll-target="#contexto">Contexto</a></li>
  <li><a href="#preliminares" id="toc-preliminares" class="nav-link" data-scroll-target="#preliminares">Preliminares</a></li>
  <li><a href="#pregunta-1" id="toc-pregunta-1" class="nav-link" data-scroll-target="#pregunta-1">Pregunta 1</a></li>
  <li><a href="#pregunta-2" id="toc-pregunta-2" class="nav-link" data-scroll-target="#pregunta-2">Pregunta 2</a></li>
  <li><a href="#pregunta-3" id="toc-pregunta-3" class="nav-link" data-scroll-target="#pregunta-3">Pregunta 3</a></li>
  <li><a href="#pregunta-4" id="toc-pregunta-4" class="nav-link" data-scroll-target="#pregunta-4">Pregunta 4</a></li>
  <li><a href="#pregunta-5" id="toc-pregunta-5" class="nav-link" data-scroll-target="#pregunta-5">Pregunta 5</a></li>
  <li><a href="#pregunta-6" id="toc-pregunta-6" class="nav-link" data-scroll-target="#pregunta-6">Pregunta 6</a></li>
  <li><a href="#pregunta-7" id="toc-pregunta-7" class="nav-link" data-scroll-target="#pregunta-7">Pregunta 7</a></li>
  <li><a href="#pregunta-8" id="toc-pregunta-8" class="nav-link" data-scroll-target="#pregunta-8">Pregunta 8</a></li>
  <li><a href="#pregunta-9" id="toc-pregunta-9" class="nav-link" data-scroll-target="#pregunta-9">Pregunta 9</a></li>
  <li><a href="#pregunta-10" id="toc-pregunta-10" class="nav-link" data-scroll-target="#pregunta-10">Pregunta 10</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analítica de los Negocios</h1>
<p class="subtitle lead">Parcial II</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Antes de empezar a resolver el parcial, lea todas las preguntas y, de acuerdo a su criterio, abra las diapositivas y scripts que considere útiles. Nadie debería tener abierto el correo luego de 5 minutos a menos que sea para enviar el parcial con todas las respuestas. <strong>El uso de ChatGPT (o cualquier otra plataforma de IA) no está permitido.</strong> Todas las respuestas deben ir en un documento PDF creado en Quarto o en un R Script con las respuestas como comentarios. Como se mencionó anteriormente, aquellos que entreguen las respuestas en Quarto recibirán un +0.5 en el parcial.</p>
<p>Para aquellos que van a entregar el documento en Quarto, les sugiero primero escribir el código en un R Script, corroborar que se está ejecutando correctamente y, luego, pasar las respuestas al documento <code>.qmd</code>. No incluyan el código de las gráficas que utilicen en el documento final; para el resto de las respuestas, es obligatorio incluirlo.</p>
<p><strong>Criterios de evaluación:</strong></p>
<p>✔ Código correcto y bien estructurado: si el código no ejecuta, descuento la mitad del punto.</p>
<p>✔ Gráficos generados correctamente: Uso de <code>ggplot2</code> con etiquetas claras y colores adecuados.</p>
<p>✔ Interpretación y análisis: Respuesta clara a las preguntas en comentarios y que sea concisa. Si su respuesta tiene más de 3 líneas es <strong>muy</strong> larga.</p>
<p>✔ Formato y organización: Código limpio, comentado y con títulos adecuados en el documento.</p>
<p><strong>Tienen 2 horas y media</strong> para resolver el parcial, por lo que hay tiempo suficiente para acortar cualquier respuesta. Cada punto vale 0,5.</p>
<p>Éxitos!</p>
<section id="contexto" class="level3">
<h3 class="anchored" data-anchor-id="contexto">Contexto</h3>
<p>En 2021, Blizzard Entertainment inició un proyecto de análisis de datos sobre los aumentos salariales de sus empleados. Esto fue en respuesta a las crecientes preocupaciones sobre prácticas de compensación en la industria de videojuegos, desencadenadas por un archivo de Excel anónimo que revelaba salarios internos. El objetivo era identificar posibles disparidades en los ajustes salariales entre diferentes grupos de empleados y niveles de desempeño (Fuente: <a href="https://www.bloomberg.com/news/articles/2020-08-03/blizzard-workers-share-salaries-in-revolt-over-wage-disparities" target="_blank">Blizzard Workers Share Salaries in Revolt Over Pay</a>).</p>
<p>Suponga que usted hace parte de este equipo. El nombre de los datos que usarán para este análisis es <code>blizzard_salary</code> y las variables relevantes son:</p>
<ul>
<li><p><code>incr_porcentual</code>: Aumento dado en julio de 2020, como incremento porcentual con valores entre 1 (aumento del 1%) al 21.5 (incremento del 21.5%)</p></li>
<li><p><code>tipo_contrato</code>: Tipo de contrato, con las categorías <code>Contrato por Hora</code> y <code>Contrato Fijo</code></p></li>
<li><p><code>salario_anual</code>: Salario anual, en doláres (USD), con valores entre $25,000 y $216,856.</p></li>
<li><p><code>nivel_performance</code>: El nivel de la revisión del desempeño más reciente, con categorías <code>Malo</code>, <code>Normal</code>, <code>Bueno</code>, y <code>Excelente</code>.</p></li>
</ul>
<p>Las diez primeras filas de los datos <code>blizzard_salary</code> son las siguientes:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 409 × 4
   incr_porcentual tipo_contrato     salario_anual nivel_performance
             &lt;dbl&gt; &lt;chr&gt;                     &lt;dbl&gt; &lt;fct&gt;            
 1             1   Contrato Fijo            25000  Bueno            
 2             1   Contrato Fijo            25000  Normal           
 3             1   Contrato Fijo            25000  Bueno            
 4             1   Contrato por Hora        33987. Normal           
 5            NA   Contrato por Hora        34798. Bueno            
 6            NA   Contrato por Hora        35360  &lt;NA&gt;             
 7            NA   Contrato por Hora        37440  &lt;NA&gt;             
 8             0   Contrato por Hora        37814. &lt;NA&gt;             
 9             4   Contrato por Hora        41101. Excelente        
10             1.2 Contrato por Hora        42328  &lt;NA&gt;             
# ℹ 399 more rows</code></pre>
</div>
</div>
</section>
<section id="preliminares" class="level3">
<h3 class="anchored" data-anchor-id="preliminares">Preliminares</h3>
<p>Carguen los paquetes <code>tidyverse</code>, <code>broom</code> y <code>glance</code>. Además, carguen los datos con el siguiente nombre:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>blizzard_salary <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"blizzard_salary.csv"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pregunta-1" class="level3">
<h3 class="anchored" data-anchor-id="pregunta-1">Pregunta 1</h3>
<p>Una de las variables de interés es el incremento salarial que recibieron los trabajadores. Examinemos cómo se distribuye la variable <code>incr_porcentual</code>. Grafiquen un diagrama de caja para esta variable y mencionen dos observaciones concretas sobre el comportamiento de su distribución.</p>
</section>
<section id="pregunta-2" class="level3">
<h3 class="anchored" data-anchor-id="pregunta-2">Pregunta 2</h3>
<p>Supongamos que uno de sus compañeros escribió un código como parte de su análisis de los datos para analizar la tendencia central de los salarios por tipo de contrato. Luego imprimió los resultados que se muestran a continuación. Desafortunadamente, el valor indicado con _____ se borró de la impresión.</p>
<pre><code># A tibble: 2 x 3
  tipo_contrato     salario_anual_promedio salario_anual_mediana
  &lt;chr&gt;                              &lt;dbl&gt;                 &lt;dbl&gt;
1 Contrato Fijo                     90472.                83381 
2 Contrato por Hora                 63003.                _____</code></pre>
<p>¿Cuál de los siguientes valores es el mejor estimado para el número faltante? Reescriban el código que utilizó su compañero para llegar al valor.</p>
<ol type="a">
<li>30,000</li>
<li>50,000</li>
<li>80,000</li>
<li>100,000</li>
</ol>
</section>
<section id="pregunta-3" class="level3">
<h3 class="anchored" data-anchor-id="pregunta-3">Pregunta 3</h3>
<p>¿Cuál de las distribuciones de salario anual tiene una desviación estándar mayor?</p>
<ol type="a">
<li>Trabajadores con nivel bueno en su performance</li>
<li>Trabajadores con nivel malo en su performance</li>
<li>Más o menos tienen la misma</li>
</ol>
<p>Luego de obtener el resultado en R, expliquen por qué tiene sentido que ese grupo tenga una mayor, menor o igual desviación estándar en los salarios.</p>
</section>
<section id="pregunta-4" class="level3">
<h3 class="anchored" data-anchor-id="pregunta-4">Pregunta 4</h3>
<p>Creen una nueva variable <code>aumento</code> que sea el incremento en el salario que tendrían los trabajadores luego de 2020 (Se multiplicaría el salario anual por<code>(incr_porcentual/100)</code>). Uno de sus colegas le pide graficar la dispersión entre las variables <code>aumento</code> y <code>salario_anual</code>. ¿Cuál sería su conclusión sobre la relación entre el salario base y el incremento basándose en la gráfica?</p>
</section>
<section id="pregunta-5" class="level3">
<h3 class="anchored" data-anchor-id="pregunta-5">Pregunta 5</h3>
<p>El jefe del equipo de trabajo sugiere que los salarios anuales (<code>salario_anual</code>) son el primer predictor de los incrementos (<code>incr_porcentual</code>). El modelo <code>aumento_1</code> estima la siguiente ecuación:</p>
<p><span class="math display">\[\widehat{\text{Incremento Porcentual}}=\hat{\beta_0}+\hat{\beta_1}\times \text{Salario Anual}\]</span></p>
<p>¿Cual de las siguientes interpretaciones es la mejor para el coeficiente de la pendiente?</p>
<ol type="a">
<li>Por cada $1,000 de salario anual, el modelo predice que el aumento salarial será mayor por 1.59% en promedio.</li>
<li>Por cada $1,000 de salario anual, el aumento salarial sube por 0.0159%.</li>
<li>Por cada $1,000 de salario anual, el modelo predice que el aumento salarial será mayor por 0.0159% en promedio.</li>
<li>Por cada $1,000 de salario anual, el modelo predice que el aumento salarial será mayor por 1.83% en promedio.</li>
</ol>
</section>
<section id="pregunta-6" class="level3">
<h3 class="anchored" data-anchor-id="pregunta-6">Pregunta 6</h3>
<p>Evalúen con una prueba de hipótesis si el coeficiente <span class="math inline">\(\hat{\beta_1}\)</span> de la regresión del punto 5 es estadísticamente diferente de 0.</p>
</section>
<section id="pregunta-7" class="level3">
<h3 class="anchored" data-anchor-id="pregunta-7">Pregunta 7</h3>
<p>Seleccione una condición (linealidad, varianza constante o normalidad de los errores) y analice si el modelo <code>aumento_1</code> la cumple, utilizando gráficas para justificar su respuesta.</p>
</section>
<section id="pregunta-8" class="level3">
<h3 class="anchored" data-anchor-id="pregunta-8">Pregunta 8</h3>
<p>Dos de sus colegas proponen dos modelos diferentes para predecir <code>incr_porcentual</code>. El primer modelo, al que llaman <code>modelo_1</code>, hace la estimación usando salario anual y una variable dummy si el trabajador tiene un contrato fijo de la siguiente manera:</p>
<p><span class="math display">\[\widehat{\text{Incremento Porcentual}}=\hat{\beta_0}+\hat{\beta_1}\times \text{Salario Anual}+\hat{\beta_2}\times \text{Contrato Fijo}\]</span></p>
<p>Por otro lado, el segundo modelo llamado <code>modelo_2</code>, utilizaría variables dummy para las categorías de <code>nivel_performance</code> estimando:</p>
<p><span class="math display">\[\begin{align*}
\widehat{\text{Incremento Porcentual}} =\ &amp; \hat{\beta_0} + \hat{\beta_1} \times \text{Salario Anual} + \hat{\beta_2} \times \text{Malo} \\
&amp; + \hat{\beta_3} \times \text{Normal} + \hat{\beta_4} \times \text{Excelente}
\end{align*}\]</span></p>
<p>¿Cuál de los dos modelos elegiría usted y cuál sería su criterio?</p>
</section>
<section id="pregunta-9" class="level3">
<h3 class="anchored" data-anchor-id="pregunta-9">Pregunta 9</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  term                         estimate  std.error statistic  p.value
  &lt;chr&gt;                           &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)                 3.52      0.515           6.84 5.01e-11
2 salario_anual               0.0000102 0.00000443      2.30 2.20e- 2
3 nivel_performanceMalo      -4.07      1.42           -2.86 4.55e- 3
4 nivel_performanceNormal    -2.40      0.397          -6.03 5.12e- 9
5 nivel_performanceExcelente  2.99      0.714           4.19 3.77e- 5</code></pre>
</div>
</div>
<p>Cuando uno de sus colegas ve el resultado de la estimación, comenta: ‘El coeficiente para <code>nivel_performanceNormal</code> es negativo, ¡qué raro! Supongo que significa que las personas con desempeño Normal reciben un aumento menor.’ ¿Es correcto su comentario? Si no lo es, expliquen por qué.</p>
</section>
<section id="pregunta-10" class="level3">
<h3 class="anchored" data-anchor-id="pregunta-10">Pregunta 10</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  term                             estimate  std.error statistic    p.value
  &lt;chr&gt;                               &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
1 (Intercept)                     2.12      0.470           4.51 0.00000855
2 salario_anual                   0.0000141 0.00000470      2.99 0.00294   
3 tipo_contratoContrato por Hora -0.900     0.544          -1.65 0.0993    </code></pre>
</div>
</div>
<p>¿Cuál de las siguientes gráficas explica el modelo estimado? Explique su respuesta.</p>
<div id="fig-raise-salary-type" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-raise-salary-type-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-raise-salary-type-1.svg" class="quarto-discovered-preview-image img-fluid figure-img" data-ref-parent="fig-raise-salary-type"></p>
<p></p><figcaption class="figure-caption">(a) Opción 1</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-raise-salary-type-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-raise-salary-type-2.svg" class="img-fluid figure-img" data-ref-parent="fig-raise-salary-type"></p>
<p></p><figcaption class="figure-caption">(b) Opción 2</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-raise-salary-type-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-raise-salary-type-3.svg" class="img-fluid figure-img" data-ref-parent="fig-raise-salary-type"></p>
<p></p><figcaption class="figure-caption">(c) Opción 3</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-raise-salary-type-4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-raise-salary-type-4.svg" class="img-fluid figure-img" data-ref-parent="fig-raise-salary-type"></p>
<p></p><figcaption class="figure-caption">(d) Opción 4</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figura&nbsp;1: Visualición de la relación entre incremento porcentual, salario anual y tipo de contrato</figcaption><p></p>
</figure>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>